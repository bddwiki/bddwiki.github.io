<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical href=/behaviourdrivenprogrammingexample/><title>BehaviourDrivenProgrammingExample | BDD Wiki</title><link href=css/fontawesome.min.css rel=stylesheet><link rel=stylesheet href=/css/ace.min.css></head><body><nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow sticky-top" id=navbarMain><div class=container><div><a class=navbar-brand href=/>BDD Wiki</a></div></div></nav><div class=container-fluid><div class=row><div class="docs-sidenav order-0 col-12 col-md-3 col-lg-2 col-xl-2 position-sticky border-right"><nav class="navbar navbar-expand-md navbar-light pl-0"><button class="navbar-toggler navbar-toggler-right collapsed" type=button data-toggle=collapse data-target=#sidenav-left-collapse aria-controls=sidenav-left-collapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse align-items-start flex-column" id=sidenav-left-collapse><form class="form-inline my-2 my-lg-0 searchbox"><input class="form-control mr-sm-2 w-100" data-search-input id=search-by type=text placeholder=Search></form><ul class="navbar-nav flex-column pt-3"></ul></div></nav></div><div class="docs-toc large order-lg-2 order-md-0 order-xs-1 col-12 col-lg-2 col-xl-2 position-sticky border-left"><div class=docs-toc><nav id=TableOfContents></nav></div></div><div class="main col-12 order-1 col-md-9 col-lg-10 col-xl-8 py-3"><h1>BehaviourDrivenProgrammingExample</h1><p>In this example we have a banking application and we want to transfer balances between accounts. We’ll make this transfer using a <code>BalanceTransferService</code> class.</p><p>We’ll start, using the JUnit framework, where we’ll define a behaviour class:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BalancetransferServiceBehaviour</span> <span style=color:#66d9ef>extends</span> TestCase <span style=color:#f92672>{</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>Working from our PowerfulQuestions, the “next most important thing” we want is a simple balance transfer.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BalancetransferServiceBehaviour</span> <span style=color:#66d9ef>extends</span> TestCase <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>shouldTransferBalanceFromAccountWithSufficientFunds</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        <span style=color:#f92672>...</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>We expect that whatever our implementation the result will be some interactions with a source and destination bank accounts, so we will provide two mock accounts, to support our specification of the expected behaviour and we’ll define what we expect to see in terms of these interactions. In this example we expect that the source account will be debited $20 and the target account will be credited by the same amount. Using the popular JMock framework, this looks like:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BalancetransferServiceBehaviour</span> <span style=color:#66d9ef>extends</span> TestCase <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>shouldTransferBalanceFromAccountWithSufficientFunds</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
    <span style=color:#75715e>// create mock instances
</span><span style=color:#75715e></span>    Mock fromAccount <span style=color:#f92672>=</span> mock<span style=color:#f92672>(</span>Account<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>);</span>
    Mock toAccount <span style=color:#f92672>=</span> mock<span style=color:#f92672>(</span>Account<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>);</span>

    <span style=color:#75715e>// set expectations
</span><span style=color:#75715e></span>    fromAccount<span style=color:#f92672>.</span><span style=color:#a6e22e>expects</span><span style=color:#f92672>(</span>once<span style=color:#f92672>()).</span><span style=color:#a6e22e>method</span><span style=color:#f92672>(</span><span style=color:#960050;background-color:#1e0010>“</span>debit<span style=color:#960050;background-color:#1e0010>”</span><span style=color:#f92672>).</span><span style=color:#a6e22e>with</span><span style=color:#f92672>(</span>20<span style=color:#f92672>).</span><span style=color:#a6e22e>isVoid</span><span style=color:#f92672>();</span>
    toAccount<span style=color:#f92672>.</span><span style=color:#a6e22e>expects</span><span style=color:#f92672>(</span>once<span style=color:#f92672>()).</span><span style=color:#a6e22e>method</span><span style=color:#f92672>(</span><span style=color:#960050;background-color:#1e0010>“</span>credit<span style=color:#960050;background-color:#1e0010>”</span><span style=color:#f92672>).</span><span style=color:#a6e22e>with</span><span style=color:#f92672>(</span>20<span style=color:#f92672>).</span><span style=color:#a6e22e>isVoid</span><span style=color:#f92672>();</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>Our customer tells us that the next most important behaviour is what happens when the source account has insufficient funds. In this instance, as a first step, we will prime the source account to fail. We decide on the behaviour of our BalanceTransferService when there are insufficient funds. It could silently fail? Raise an exception? Or log a failure message somewhere? For now we decide it most sensible to raise a runtime exception: since it can&rsquo;t recover the situation without some help. So our new behaviour specification looks like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>shouldThrowExceptionIfThereAreInsufficientFunds</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
    <span style=color:#75715e>// ...
</span><span style=color:#75715e></span>    fromAccount<span style=color:#f92672>.</span><span style=color:#a6e22e>expects</span><span style=color:#f92672>(</span>once<span style=color:#f92672>()).</span><span style=color:#a6e22e>method</span><span style=color:#f92672>(</span><span style=color:#960050;background-color:#1e0010>“</span>debit<span style=color:#960050;background-color:#1e0010>”</span><span style=color:#f92672>).</span><span style=color:#a6e22e>with</span><span style=color:#f92672>(</span>20<span style=color:#f92672>)</span>
        <span style=color:#f92672>.</span><span style=color:#a6e22e>will</span><span style=color:#f92672>(</span>throwException<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> InsufficientFundsException<span style=color:#f92672>());</span>
    <span style=color:#75715e>// ...
</span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</code></pre></div><p>If you&rsquo;re writing specs like this using JUnit, you can then go on to generate a full specification list from your tests, for example by using <a href=http://agiledox.sourceforge.net/>TestDox</a>, or by using the <a href=http://ant.apache.org/manual/OptionalTasks/junitreport.html>junitreport ant task</a> with a <a href=http://www.kerrybuckley.com/2006/09/25/an-alternative-approach-to-creating-specs-from-junit-tests>custom stylesheet</a>.</p><div class=row></div></div></div></div><script src=lib/jquery.min.js></script><script src=lib/popper.min.js></script><script src=js/bootstrap.min.js></script><script type=text/javascript src=/plugins/lunr.min.js></script><script type=text/javascript src=/plugins/auto-complete.js></script><link href=/plugins/auto-complete.css rel=stylesheet><script type=text/javascript>var baseurl="";</script><script type=text/javascript src=/plugins/search.js></script><script type=text/javascript src=/plugins/clipboard.js></script><script>new ClipboardJS('.btn');</script></body></html>